# Cryptography(암호학)  
제 3자로부터 정보를 보호하는 방법에 대한 연구  
핵심이 되는 연구 주제: 키 생성(Key generation), 암호화(Encryption), 복호화(Decryption)  
* 키 생성: 암복호화에 사용할 키를 만드는 과정  
* 암호화: 키를 이용해 평문(Plaintext)을 암호문(Ciphertext)으로 변환하는 과정  
* 복호화: 송신자가 암호문을 전송하면 수신자는 키를 이용해 암호문을 평문으로 복호화  
+) 현대에는 암호학의 역할 확장; 수신자와 송신자가 서로의 신원을 확인하는 방법, 메세지가 중간에 조작되지 않았음을 보증하는 방법 등  

암호화와 복호화로 정보가 전달되는 체계를 **암호 시스템(Cryptosystem)** 이라고 함  

> **인코딩**  
> 암호화와 비교되어 자주 소개되는 개념.  
> 암호화와 유사하게 데이터를 다른 형태로 변환하는 것.  
> 그러나 인코딩은 데이터의 기밀성을 고려하지 X, 누구나 디코딩하여 원문을 구할 수 있음.  
> 데이터를 숨기기 위해 사용하기 보다는 크기를 줄이거나 컴퓨터가 이해하기 쉬운 형식으로 변형하고 사용함.  
> 압축도 인코딩의 예시 중 하나.  


## 배경지식  

### 배타적 논리합  
eXclusive OR, XOR. 
입력으로 들어온 두 인자가 서로 다를 때, 참을 반환하는 연산  
암호학에서 일반적으로 비트 단위로 이뤄짐  
두 입력값을 2진법으로 표기했을 때 각 자릿수의 값이 다르면 1, 같으면 0  

### 합동식  
두 정수 a,b를 각각 정수 m으로 나눴을 때 나머지가 같은지 판별하는 식  
나머지가 같을 때, 수학적으로 a와 b가 mod m에 대해 합동(congruent)이라고 표현  

a,b가 mod m에 대해 합동일 경우,  
a, b 각각에 정수 x를 더하거나 빼거나 곱해도 여전히 합동  
그러나 나눗셈에 대해서는 성립 X  

#### 합동식에서 곱셈의 역원  
정수 a, ma,m에 대해 a × b ≡ 1(mod m)을 만족하는 b를 mod m에 대한 a의 곱의 역원이라고 부르며 a^{-1}로 표기  
ex) 2 × 4 = 8 ≡ 1(mod 7)이므로 mod 7에서 2에 대한 역원은 4  
역원은 a와 m이 서로소일 때에만 존재  

## 고전 암호  
컴퓨터와 같이 고성능 연산 장치가 발명되기 전, 비교적 간단한 기계와 손 등으로 암복호화를 수행하던 암호  
대부분 컴퓨터를 사용하면 쉽게 복호화되어 현대에는 사용되지 않음  

고전 암호는 일반적으로 치환과 전치의 방법으로 설계됨  
* 치환(Substitution): 평문의 문자를 다른 문자로 바꾸는 것  
* 전치(Transposition): 평문 문자들의 위치를 바꾸는 것  

단순한 고전 암호: 한 가지 원리만을 사용하는 치환 암호(Substitution Cipher) 또는 전치 암호(Transposition Cipher)  
복잡한 고전 암호는 두 원리를 모두 사용  

### 치환 암호  

#### 단일 문자 치환 암호(Monoalphabetic Substitution Cipher)  
평문의 각 문자를 약속된 다른 문자로 치환하는 암호  
복호화를 위해 치환의 대응 관계는 1:1 대응  
(평문의 'A'가 암호문의 'B'로 치환된다면, 평문의 다른 어떤 문자도 'B'로 치환되지 않음)  

* 카이사르 암호(Caesar Cipher)  
평문의 각 알파벳을 일정한 거리만큼 밀어서 다른 알파벳으로 치환. 복호화는 다시 원래 위치로 밀어서.  
송신자와 수신자가 사전에 합의해야 통신 가능  
알파벳 밀어낸 횟수를 키(Key)라고 함. 이것만 알아내면 해독 가능  
ex) 알파벳은 총 26자이므로 가능한 키의 갯수는 26개  

* 춤추는 인형 암호  
조금 더 복잡한 치환 암호로 셜록 홈즈에 나옴. 사람 한명이 글자 하나에 대응.  
알파벳을 서로 다른 기호와 무작위로 일대일 대응시켜 치환하면 키 공간의 크기는 26!  

단점: 언어가 지닌 통계적 특성이 유지된다는 단점 있음.  
ex) 영어 문장에서 가장 많이 사용되는 알파벳 e. 따라서 단일 치환 암호가 적용된 어떤 암호문에서 b가 가장 많이 등장한다면, b는 e가 치환된 것이라 추측할 수 있음.  

* 난수표, 코드북  
송신자와 수신자가 책을 정하고, 송신자가 책의 페이지 x와 단어의 인덱스 y를 보내면, 수신자는 책 x 페이지의 y번째 단어를 확인하여 송신자의 메세지 해독  
ex) 21536, 21529 -> 215페이지의 37번째 단어, 215페이지의 29번째 단어  

#### 다중 문자 치환 암호(Polyalphabetic Substitution Cipher)  
평문의 한 문자가 암호문에서 여러 종류의 문자로 치환됨  

* 비제네르 암호(Vigenere Cipher)  
암호화와 복호화가 미리 정해진 키워드를 통해 이뤄짐  
키워드를 반복하며 키워드의 각 행에서 평문즤 문자에 대응되는 문자를 평문으로 치환함  
[비제네르 표](https://learn.dreamhack.io/70#6) 참고  

### 전치 암호  
평문을 구성하는 문자의 순서를 재배열하여 암호문 만듬  
평문을 정해진 길이의 블록들로 나누고, 규칙을 적용하여 블록 안의 문자를 재배치  

* 스키테일 암호(Scytale Cipher). 
기원전 450년에 고대 그리스인들이 발견. 나무봉(Scytale)을 이용한 암호로, 메세지를 교환할 두 사람이 같은 크기의 나무봉 제작  
그 뒤 송신자는 종이 테이프를 나무봉에 감고, 테이프 위에 세로로 메세지를 기입하여 암호문 만듬  
종이테이프를 풀어내면 순서가 뒤섞여 메세지를 읽을 수 없지만, 같은 나무봉을 가진 수신자는 테이프를 다시 나무봉에 감아서 이를 해석할 수 있음.  

### 고전 암호 공격  

#### 전수 키 탐색 공격(Exhaustive Key Search Attack)  
평문과 암호문을 알 때, 키 공간을 전부 탐색하며 주어진 암호문과 같은 암호문을 생성하는 키를 찾는 방법  
단순한 공격. 키 공간의 크기가 작다면 빠른 시간 안에 키를 찾고 암호 해독 가능.  
ex) 단일 치환 암호인 카이사르 암호는 키 공간이 26으로 매우 작기 때문에 전수 키 탐색 공격에 취약  

#### 빈도수 공격(Frequency Analysis)  
단일 치환 암호의 통계적 특성(대상 언어의 특성) 이용. 추측을 바탕으로 암호문 복구.  
다중 치환 암호는 이러한 통계적 특성이 사라지기 때문에 빈도수 공격으로부터 비교적 안전.  


## 현대 암호  

### 혼돈과 확산  
1945년에 암호학자 Calude Shannon은 안전한 암호 시스템은 혼돈(Confusion)과 확산(Diffusion)의 성질을 만족해야 한다고 발표함  
현대의 많은 암호 시스템이 두 성질을 따르고 있음.  

#### 혼돈  
암호문에서 평문의 특성을 알아내기 힘든 성질  
공격자는 암호문을 보고 평문이 무엇인지 유추하지는 못하더라도 암호문을 생성한 두 평문이 같다는 사실은 알 수 있음.  
따라서 단일 치환 암호는 혼돈 성질을 만족하지 못하는 암호!  

#### 확산  
확산은 평문의 작은 변화가 암호문의 큰 변화로 이어지는 성질.  
이 성질은 대부분의 고전 암호에서 찾아보기 힘든 성질.  

### 대칭키 암호 시스템(Symmetric Key Cryptosystem)  
송신자와 수신자가 같은 키를 공유해야하는 암호 시스템  
사전에 서로 키 공유하는 과정이 반드시 필요.  
외부인이 키 공유 과정을 도청해도 공유되는 키는 알지 못하게 하는 **키 공유 알고리즘(Key-Sharing Algorithm)** 연구가 발달됨  
ex) Diffle-Hellman 키 교환 알고리즘. 

#### 블록 암호(Block Cipher)  
평문을 정해진 크기의 블록 단위로 암호화  
ex) 블록 크기가 4바이트면 평문을 4바이트의 블록으로 쪼개어 각 블록마다 암호화 진행  
평문의 크기가 블록 크기의 배수가 아니라서 블록을 균등하게 쪼갤 수 없다면? 평문 뒤에 데이터를 추가하는 **패딩(Padding)** 수행, 평문이 블록 크기의 배수가 될 때까지 데이터 추가  

* DES  
* AES  

#### 스트림 암호(Stream Cipher)  
송수신자가 공유하는 데이터 스트림을 생성하고 이를 평문에 XOR하는 암호  
X xor X = 0이므로 수신자는 C xor X = P xor X xor X = P로 암호문을 복호화할 수 있음(C: 암호문, P: 평문, X: 스트림)  

만약 송신자와 수신자가 평문 길이 만큼의 스트림을 매번 공유할 수 있다면, 스트림을 모르는 공격자는 암호문을 복호화할 수 없음.  
하지만 평문과 같은 길이의 스트림을 안전하게 공유할 수 있다면, 스트림을 공유하는 채널로 평문을 공유하면 되므로 암호화가 필요하지 않은 환경임을 의미.  

그래서 일반적으로 송신자와 수신자는 스트림을 공유하는 대신, **시드(Seed)** 라 불리는 작은 값을 공유하고, 이를 사전에 합의된 함수의 인자로 넣어 스트림을 각자 생성.  
스트림 암호는 단순한 연산으로만 구현되므로 속도가 매우 빠름.  
그러나 블록암호보다는 안전하지 못하다고 알려져서 연산 능력이 부족한 임베디드 기기나 속도가 중요한 환경에서만 제한적으로 사용됨.  

#### 장단점  
* 장점  
공개키 암호 시스템에 비해 속도 빠름  

* 단점  
송신자와 수신자가 사전에 키를 교환해야함  
그룹 내 여러명이 있을 경우, 두 사람마다 서로 다른 키 생성해서 공유해야함. 즉, N명의 사람끼리 총 N(N-1)/2개의 키가 필요  
새로운 상대와 통신할 때마다 계속 키를 생성해야 함(확장성 문제)  


### 공개키 암호 시스템(Public Key Cyptosystem)  
비대칭키 암호 시스템(Asymmetric Cryptography)라고도 함  
송신자와 수신자가 서로 다른 키를 사용  

송신자는 수신자의 **공개키(Public Key)** 로 데이터 암호화하여 수신자에게 전송  
수신자는 자신의 **비밀키(Priate Key)** 로 이를 복호화  

공개키는 모두에게 공개되어 있으므로 공개키를 아는 사람은 누구나 수신자에게 암호문을 보낼 수 있음  
그러나 복호화는 개인키를 알고 있는 수신자만 가능  

#### 장단점
* 장점  
그룹 내의 사람들이 각자의 공개키와 비밀키를 만든 후 공개키만 공개하면 되므로 N명의 사람이 있을 때 2N개의 키만 필요.  
이는 N(N−1)/2 개의 키가 필요했던 대칭키 암호 시스템보다 훨씬 적다.  
또한 한 번 키를 생성하고 나면, 새로운 상대와 통신하더라도 자신이 키를 다시 만들어야할 필요가 없음.  

* 단점  
대칭키 암호 시스템에 비해 다소 복잡한 연산이 필요하므로 속도가 느림.  
대칭키 암호와 같은 안전성을 제공하려면, 대칭키 암호보다 긴 키를 사용해야 함.  
ex) 대칭키 암호 시스템인 AES는 192 비트 이상의 키를 사용하면 충분히 안전하지만, 공개키 암호 시스템인 RSA는 2048 비트 이상의 키를 사용할 것이 권장됨.  

### 암호의 기능  
정보보안의 목표  

#### 1. 기밀성(Confidentiality)  
기밀성은 허락된 사람만이 정보를 열람할 수 있게 하는 기능. 여기서 허락된 사람은 일반적으로 키를 가지고 있는 사람.  

#### 2. 무결성(Integrity)  
무결성은 송신자가 보낸 정보에 변조가 일어나지 않았음을 의미.  
ex) 송신자가 데이터를 보냈는데, 누군가가 이를 가로채어 조작하고, 수신자에 전달할 수 있음. 혹은 네트워크 상의 문제로 이 중 일부가 변경될 수 있음.  
무결성은 이러한 데이터의 변화가 발생하지 않았음을 보증하는 기능  

#### 3. 인증(Authentication)  
인증은 정보를 주고 받는 상대방의 신원을 확인하는 기능.  
얼굴도 보이지 않고, 신분증도 교환할 수 없는 네트워크에서 서로가 신뢰할 수 있는 것은 인증 시스템이 갖춰져 있기 때문.  
ex) 공인인증서, 웹에서 아이디와 비밀번호를 입력.  

#### 4. 부인 방지(Non-repudiation)  
부인 방지는 정보를 교환한 이후에 교환한 사실을 부인할 수 없게 하는 기능.  
온라인상에서 거래가 발생했을 때 돈을 수신한 쪽에서 수신한 사실을 부인할 수 있다면 온라인 거래는 불가능할 것.  



